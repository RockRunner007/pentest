#!/bin/bash

# Azure
# https://learn.microsoft.com/en-us/powershell/module/az.network/get-azpublicipaddress?view=azps-11.2.0
# https://portal.azure.com/#view/HubsExtension/ArgQueryBlade

# Get-AzPublicIpAddress | select Id,Name,IpAddress,PublicIpAllocationMethod,ResourceGroupName
# IP List
az network public-ip list -o table > artifacts/audit/size_azure_$1.txt

# All Resources per subscription
# az resource list -o table > artifacts/audit/resource_azure_test_full.txt

# Counts per subscription
# az graph query -q "Resources | project name, type | summarize count() by type" -o json > artifacts/audit/resource_azure_test.json

# Count sum as csv per subscription
# az graph query -q "Resources | project name, type | summarize count() by type" | jq -r '.data[] | [.type, .count_]  | @csv'  > artifacts/audit/resource_azure_test_sum.csv

# Count by type per subscription
# https://learn.microsoft.com/en-us/azure/governance/resource-graph/reference/supported-tables-resources
# az graph query -q "Resources | project name, type | where type=~ 'Microsoft.Compute/disks' | summarize count() by type"